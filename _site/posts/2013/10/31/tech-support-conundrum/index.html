<!DOCTYPE html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7"><![endif]-->
<!--[if IE 7]><html class="no-js lt-ie9 lt-ie8"><![endif]-->
<!--[if IE 8]><html class="no-js lt-ie9"><![endif]-->
<!--[if gt IE 8]><!--><html class="no-js" lang="en"><!--<![endif]-->
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <title>Nick on Computing: Tech Support Conundrum</title>
    <meta name="description" content />
    <meta name="viewport" content="width=device-width" />
    <link rel="alternate" type="application/atom+xml" title="Posts" href="../../../../../atom.xml" />
    <link type="image/png" rel="icon" href="../../../../../images/favicon.png" />
    <link type="text/css" rel="canonical" href="http://www.nickmcavoy.com/">
    <link type="text/css" rel="stylesheet" href="../../../../../css/responsive.css" />
    <link type="text/css" rel="stylesheet" href="../../../../../css/main.css" />
    <link type="text/css" rel="stylesheet" href="http://fonts.googleapis.com/css?family=Fjalla+One">
    <script src="../../../../../js/vendor/modernizr-2.6.2-respond-1.1.0.min.js"></script>
  </head>
  <body>
    <div class="container">
      <header>
        <hgroup>
          <h1 id="logo">
            <a href="../../../../../">
              <span class="left">Nick</span><span class="center">on</span><span class="right">Computing</span>
            </a>
          </h1>
        </hgroup>
      </header>

      <nav class="navbar">
        <a href="../../../../../atom.xml" rel="subscribe-rss" title="subscribe via RSS" class="subscribe pull-right"><img alt="RSS" src="../../../../../images/rss.png" /></a>
        <form action="http://google.com/search" method="get" class="navbar-form pull-right">
          <fieldset role="search">
            <input type="hidden" name="q" value="site:nickmcavoy.com" />
            <input class="span2" type="text" name="q" results="0" placeholder="Search" />
          </fieldset>
        </form>
        <div class="navbar-inner">
          <ul class="nav">
            <li><a href="../../../../../">Posts</a></li>
            <li><a href="../../../../../about/">About</a></li>
            <li><a href="http://github.com/ohbadiah/nickmcavoy-dotcom">Source</a></li>
            <li><a href="http://twitter.com/ohbadiah">Twitter</a></li>
          </ul>
        </div>
      </nav>

      <div id="content">
        <article>
  <header>
    <h1 class="entry-title">
      <a href="../../../../../posts/2013/10/31/tech-support-conundrum/">Tech Support Conundrum</a>
    </h1>
    <div class="meta">
      <time datetime="2013-10-31" pubdate data-updated="true">31 October 2013</time>
      <div class="tags"><a href="../../../../../tags/Linux/">Linux</a> | <a href="../../../../../tags/adventures%20of%20Nick%20and%20Matt/">adventures of Nick and Matt</a></div>
    </div>
  </header>

  <h3 id="the-problem">The Problem</h3>
<p>The audio jack on my laptop broke, so I had to install a new operating system.</p>
<p>Tech support made me do it. Well, tech support and DRM. I had to get it fixed since I listen to music all of the time when I am computing. If my iphone wasn’t such a useless piece of hardware I would be able to transfer FLAC albums to it seamlessly through my Linux Mint installation. But since it is a useless piece of hardware my music was cruelly imprisoned, only able to speak to me through the tinniest of laptop speakers.</p>
<p>So I had to get it fixed. Fortunately the laptop was still under warranty. After the Lenovo guy over the phone was satisfied the broken jack was not caused by software, he asked me to mail it in to the repair center in Texas. That was fine, but there was one catch: they couldn’t promise my hard drive wouldn’t be wiped in the course of a repair.</p>
<p>Such was an occasion at least for a backup, but I was also worried the repair technician would get spooked by the presence of Linux on my system. What would he do when greeted with a GRUB prompt that would by default take him into not-Windows? Would he say my warranty had been voided by Free Software Poison?</p>
<!-- MORE -->

<h3 id="experiment-perilous-the-perfect-crime">Experiment Perilous: The Perfect Crime</h3>
<p>I needed to buy a hard drive to hold the backup. It seemed a good opportunity to get a solid-state drive. Maybe I would even permanently switch my 1 terabyte hard disk for the more flashy<sup>1</sup> option. Wait a minute! While I was thinking of swapping drives, I might as well move Windows from my HDD onto the SSD, then install the SSD into the laptop body. That way the tech support guy would be perfectly happy.</p>
<p>As tedious as this all may sound, it sounded like a fun project not just to me but to my good friend Matt. He pledged to join me.</p>
<h3 id="linux-fail">Linux Fail</h3>
<p>Once my SSD came, the two of us set about making a partition table to accomodate the several Windows partitions in my fragmented HDD. We tried a few tools for this, most notably GNU parted, fdisk, and the Linux Mint disk utility. All of them utterly failed in our case. The utilities would complete a couple of operations, then freak out and think there were no entries in the disk’s partition table.</p>
<p>What’s more, we were led to believe that Windows was not going to like waking up on a disk with different numbers in the partition table (as would be required on a disk of different size), on a drive of a different make than it thought it had been installed on. We moved on to plan B: Instead of installing a Windows-only HDD into my laptop, just hide Linux. Find a way to hide GRUB and to boot into Windows by default. Technician sees no evil, technician does no evil.</p>
<p>Now the SSD was only needed as a backup. But instead of leaving it merely a glorified flash drive, why not make the SSD a working Linux installation? We couldn’t see why not.</p>
<p>Shamefully, in the wake of the Linux tools’ failure to partition the drive we resorted to using Windows 7 to do the job, and it worked flawlessly. With the help of <a href="http://www.linuxliveusb.com/">this utility</a> and a flash drive, we had the newest version of Mint running on the SSD in a jiffy.</p>
<h3 id="a-security-issue">A Security Issue</h3>
<p>From there it was trivial to copy the 60 GB of files I cared about in my home directory to the SSD. A little too trivial, actually. Who was to say I had permission to copy those files if they weren’t marked readable? Well, <code>sudo</code> said. But not <code>sudo</code> on my original system; <code>sudo</code> on the new one. I didn’t need root access on the <em>source</em> disk to copy from it; I just needed it on the <em>destination.</em> That seemed a serious problem to me.</p>
<p>I suppose that is what full-disk encrpytion is for.</p>
<h3 id="hiding-grub">Hiding GRUB</h3>
<p>Hiding GRUB was easy. We could have edited the config file directly, but we preferred to use a little GUI utility that we installed through <code>apt-get</code>: <a href="https://launchpad.net/grub-customizer">grub-customizer</a>. We only needed to change two settings: <code>GRUB_DEFAULT</code> set the default OS to boot into, and <code>GRUB_TIMEOUT</code> set how long to wait before booting into that OS. With the default set to Windows and the timeout set to 0, the technician would need to look considerably deeper to notice another OS installed on the system. Most likely, she would see what she expected to and move on.</p>
<h3 id="linux-with-benefits">Linux with Benefits</h3>
<p>Our solution had one drawback: once we set the laptop to boot into Windows automatically, the normal process to boot Linux wouldn’t work. That could be annoying once the laptop came back. But our backup Linux install had already solved this problem! We could boot from <em>that</em> device, which would load GRUB, which would detect the Mint install on the HDD, which would allow us to boot into that and revert the GRUB configuration.</p>
<p>There were other benefits. Now that I had a disembodied installation with all of my files, I could boot into the SSD using another computer. That way while my laptop was gone I could continue to work and listen to music; it would be almost as if it never left.</p>
<h3 id="bios-fail">BIOS Fail</h3>
<p>In practice, the other machines I had available to me ran either Mac OS X or Windows 8. Unlike my laptop Macs don’t run BIOS; they run EFI. Likewise Windows 8 laptops have moved to UEFI. Neither system was eager to let me boot from my SSD. OS X wouldn’t even recognize the drive as mountable, and even after disabling Secure Boot the Windows laptop would only give me a cryptic information-less error message when trying to boot.</p>
<p>I could have tried harder to solve this, but given my laptop was only gone a week I didn’t find it worth it to do so. When I needed some files I used an EFI-bootable flash drive to boot into Linux on my Mac, copy the files to another partition on the flash drive, and boot back into OSX. It wasn’t exactly as convenient as I had envisioned but it worked.</p>
<h3 id="in-sum">In Sum</h3>
<p>Like all projects of this nature, I think Matt and I spent much more time than we intended and also learned more than we expected. The end result was satisfactory. Right now? I’m typing this on my laptop, listening to Gregorian chant on my sweet headphones through the audio jack.</p>
<p><sup>1</sup> Pun intended.</p>
</article>


      </div>

      <div class="social-share">
        <ul>
          <li>
            <a href="https://twitter.com/share" class="twitter-share-button" data-url="http://www.nickmcavoy.com/posts/2013/10/31/tech-support-conundrum/" data-text="Tech Support Conundrum" data-via="ohbadiah">Tweet</a>
            <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
          </li>
        </ul>
      </div>

      <footer role="contentinfo">
        <p>
          Copyright © 2013 <a href="http://nickmcavoy.com">Nicholas McAvoy</a>
          <span class="credit">Powered by <a href="http://jaspervdj.be/hakyll/">Hakyll</a></span>
        </p>
      </footer>
    </div>

    <script>window.jQuery || document.write('<script src="../../../../../js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
    <script src="../../../../../js/vendor/bootstrap.min.js"></script>
  </body>
</html>
